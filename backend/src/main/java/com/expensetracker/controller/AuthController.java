package com.expensetracker.controller;\n\nimport com.expensetracker.model.User;\nimport com.expensetracker.security.JwtUtil;\nimport com.expensetracker.service.UserService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.web.bind.annotation.*;\n\n@RestController\n@RequestMapping("/api/auth")\npublic class AuthController {\n\n    @Autowired\n    private UserService userService;\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n    @Autowired\n    private JwtUtil jwtUtil;\n\n    @PostMapping("/register")\n    public String register(@RequestBody User user) {\n        user.setPassword(passwordEncoder.encode(user.getPassword()));\n        userService.save(user);\n        return "User registered successfully";\n    }\n\n    @PostMapping("/login")\n    public String login(@RequestBody User user) {\n        User dbUser = userService.findByUsername(user.getUsername());\n        if (dbUser != null && passwordEncoder.matches(user.getPassword(), dbUser.getPassword())) {\n            return jwtUtil.generateToken(user.getUsername());\n        } else {\n            return "Invalid credentials";\n        }\n    }\n}\n